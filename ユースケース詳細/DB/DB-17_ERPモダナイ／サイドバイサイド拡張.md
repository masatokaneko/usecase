# DB-17 ERPマスタのサイドバイサイド構築（共通マスタサービス）

## 概要

従来のERP（SAP/Oracle）では、品目マスタ、取引先マスタ、勘定科目、組織階層、在庫マスタ、価格条件などの**全マスタ情報がERP内部に閉じている**のが前提だった。しかし現代の要件ではこれは限界であり、**マスタをERP外に持ち出し、「共通マスタサービス」（Master Data Service）として再構築するアプローチ**が必要になる。

DB-10の「補助簿サイドバイサイド化」が進むほど、DB-17の「マスタのサイドバイサイド化」は必然となり、ERP内のマスタを"唯一の主マスタ"として扱う時代は終わる。本ユースケースでは、ScalarDBを用いてERPマスタを外部化し、AI時代の要件に対応可能な共通マスタサービスを構築する。

## DB-17「ERPマスタのサイドバイサイド化」とは何か（定義）

従来のERP（SAP/Oracle）では、以下のマスタ情報がERP内部に閉じている：

- 品目マスタ
- 取引先マスタ
- 勘定科目
- 組織階層
- 在庫マスタ
- 価格条件

しかし現代の要件では、**マスタをERP外に持ち出し、「共通マスタサービス」（Master Data Service）として再構築するアプローチ**が必要になる。これがDB-17の領域である。

## なぜ「ERPマスタを外に出す必要があるのか」

### ERPマスタの基本問題（克服不能）

#### ① モジュールごとにマスタ定義が違う（MOデータモデルの複雑さ）

例：

- SAP ECCの「品目マスタ」は 600+ テーブル
- モジュールごとに属性が変わる（MM/SD/PP/FI/CO）

➡ AI生成コードが処理できない
➡ サイドアプリとの連携が極端に難しい

#### ② ERPマスタが「固定テーブル」で業務変化に対応できない

- 属性追加のたびにカスタマイズ
- 場合によりZテーブルが無限に増殖
- 将来の移行で100〜1000工数発生

➡ ビジネス要件の変化に追従不可能

#### ③ SAP → S/4 、Oracle EBS → Fusion 移行でマスタ再構築が不可避

クラウド移行では以下が強制される：

- マスタ項目の削減
- モデルの変更
- 廃止属性の移行作業
- 外部アプリとの参照関係の再定義

➡ ERPを"主マスタ"とする構造自体が移行のボトルネック

#### ④ AI時代の要件と全く合わない

AIアプリは以下を望む：

- 属性の高速追加
- スキーマレス
- ドメインごとにKM（知識）追加
- 非構造データ（説明文、画像、チャット）を紐付けたい

これを SAP/Oracle の固定スキーマに押し込むと破綻する。

➡ ERP内マスタは「AI時代の開発と根本的に相性が悪い」

## DB-17の解決策：ERPの"主マスタ"の役割を外側に移す（Master Service化）

DB-17はERP本体のマスタを「参照元」に格下げし、外部に**"企業共通マスタサービス（Master Data Hub）"**を構築する。その基盤として**ScalarDB MCP Server＋マルチDB一貫管理**が非常に適している。

### 仕組み（構造）

```
            ┌───────────────────┐
            │   ERP（SAP/Oracle）│
            │  Master is Consumer│
            └─────────┬─────────┘
                      ▼
           ┌──────────────────────┐
           │  DB-17 共通マスタサービス│
           │ ・変化に強い属性管理     │
           │ ・API/GraphQL提供       │
           │ ・AIが拡張可能          │
           └─────────┬─────────┘
                      ▼
     ┌────────────────────────────────────────┐
     │    DB-10 補助簿サイドアプリ（AIDD/ワークフロー） │
     └────────────────────────────────────────┘
```

## DB-10（補助簿サイド開発）との関係

**→ 相互補完、かつ強依存。DB-10が進むほどDB-17が必須になる。**

### (1) 補助簿の属性が急速に増えるため、ERPマスタが追いつかない

DB-10の補助簿には

- 部品品目の属性
- サプライヤの追加属性
- 工程／船舶／製造ロットのメタデータ
- AI推奨情報（評価、タグ、説明文）
- 担当者メモ、チャット履歴
- 外部センサデータ

など、**ERPが持てないデータ**を保持する。

→ ERPに拡張すると破綻
→ DB-17のマスタ拡張領域が必須に

### (2) 補助簿アプリは複数マスタに依存する（整合性問題の爆発）

DB-10のサイドアプリはドメインを跨ぐ：

例：調達アプリ

- AIMM評価
- サプライヤリスク
- 肯定書番号
- チャット履歴
- 工程情報

これらを SAP / Oracle の標準マスタに押し込むのは不可能。

➡ 共通マスタサービスがないと補助簿アプリの拡張性が止まる

### (3) AIが補助アプリを大量に生成するとマスタ属性が激増する

AIDDでは「ここに属性追加したい」「フラグを新設したい」という要求が毎週のように出る。

ERPでは不可能だがサイドマスタサービスなら可能。

➡ **AI時代にはサイドマスタが不可欠**
➡ DB-10をやるとDB-17が"構造的に必要"になる

## ビジネス課題

- ERP更新とともに業務プロセスを改善したいが、既存業務を止めることができない。
- ERPベンダーの開発環境やライセンスに依存するアドオンでは、開発スピードが遅くコストが高い。
- モジュールごとにマスタ定義が異なり、サイドアプリとの連携が困難。
- ERPマスタが固定テーブルで、業務変化やAI時代の要件に対応できない。
- SAP → S/4、Oracle EBS → Fusion移行時に、マスタ再構築が大きなボトルネックになる。

## システム課題

- ERPと新システム間でトランザクションを整合させる仕組みがないと、二重更新やデータ不整合が発生する。
- ERP独自言語(ABAPなど)から外部システムへ安全にアクセスする標準的な方法がない。
- モジュールごとにマスタ定義が異なり、AI生成コードが処理できない。
- マスタ属性の追加が困難で、ビジネス要件の変化に追従できない。
- 補助簿アプリが複数マスタに依存する場合、整合性問題が爆発的に増加する。

## 対象データ・環境

- ERPの基幹データ（会計、販売、在庫、人事）とマスタデータ（品目、取引先、組織、価格条件など）。
- 外部のWebアプリやモバイルアプリによる新機能。
- AI生成アプリケーションが追加する拡張属性や非構造データ。
- サプライチェーンやドメイン固有のメタデータ。

## 導入目的・効果

### ERP移行コストの大幅削減（50〜80%コスト削減）

- マスタ移行作業の難所（属性差分調整）が消える。
- ERP更新のリスクを抑えながら、新たなユーザー体験やビジネスモデルを実装できるようにする。

### AIによるマイクロアプリ増加に対応可能

- ベンダーロックインを避け、自由度の高い技術スタックで開発を進める。
- マスタ属性の高速追加が可能になり、AI生成アプリの要求に即座に対応できる。

### ERPを「薄い会計エンジン」に最適化（Clean Core）

- SAP/Oracleが推奨するモデルの完全上位互換。
- ERP本体は会計・統制のみに集中できる。

### ドメイン主導のマスタ拡張が可能（DDD）

- 部門ごとに必要な属性はサイド上で自由に追加可能。
- スキーマレスな構造により、将来の要件変化に柔軟に対応できる。

## 解決方法・ソリューション概要

ScalarDBがERP本体のDBと新システムのDBを橋渡しし、両者の間でACIDトランザクションを保証する。旧ERPシステムは従来通り運用しつつ、新機能は外部アプリとして独立したDBに実装する。各データ操作はScalarDB経由で行われるため、データが同期され、システム間の整合性が保たれる。

### DB-17の構成要素（最適解）

Scalar製品で実現する場合：

#### (1) ScalarDB MCP → マスタの「統合トランザクション制御」

- ERP／補助簿／Webアプリ／API が全て同じトランザクション整合性
- マルチDBへ柔軟に保存（例：マスタはRDB、ドキュメントはDynamoDB）

#### (2) ScalarDB（RDB）で構造化マスタを保存

- ERPと連携する品目/取引先/組織マスタ
- 正規化された属性群

#### (3) NoSQL（DynamoDB / Mongo / Postgres JSONB）で非構造属性

- AIタグ
- カスタム属性
- 品目のテキスト説明
- 添付ファイルメタ情報
- LLMが生成するノート

➡ ERPが一生対応できない領域

#### (4) ScalarDLでマスタ変更の改ざん防止・監査ログ

- 誰が
- いつ
- なぜ
- 何を更新し
- 承認は誰で
- どの外部アプリ経由か

が全て残る。

J-SOX・監査法人対応に強い。

## システム構成

### 共通マスタサービス層

- ERP側には共通DBゲートウェイを設置し、ScalarDBと通信。
- 共通マスタサービスはクラウドネイティブなDB（RDB/NoSQL）を用い、ScalarDBを介してERPデータを参照・更新。
- API/GraphQLを通じて、補助簿アプリや外部システムからマスタを参照・更新。

### マルチDB構成

- 構造化マスタ：ScalarDB（RDB）で管理
- 非構造属性：NoSQL（DynamoDB/MongoDB/Postgres JSONB）で管理
- 監査ログ：ScalarDLで改ざん防止

### 補助簿アプリ連携

- DB-10の補助簿アプリは共通マスタサービスを通じてマスタを参照・更新。
- ScalarDBがトランザクション整合性を保証し、複数システム間でのデータ不整合を防止。

### ワークフロー統合

- BPMツールやワークフローエンジンで、既存業務と新業務のプロセス統合を支援。
- マスタ変更の承認フローをScalarDLで証跡管理。

## 導入メリット・ROI

### ERPの全面更新を避けつつ段階的に機能を拡張

- プロジェクトリスクとコストを低減。
- マスタ移行作業の難所（属性差分調整）が消え、移行コストが50〜80%削減される。

### 任意のプログラミング言語やクラウドサービスを使用可能

- 社内の開発者が活躍しやすい。
- AI生成コードがマスタを安全に扱えるようになる。

### 将来的なERPベンダー変更やクラウド移行

- データ整合性を保ったまま移行できる。
- 共通マスタサービスが独立しているため、ERPの変更に影響されない。

### AI時代の要件に対応

- 属性の高速追加、スキーマレス構造、非構造データの紐付けが可能。
- AI生成アプリがマスタを自由に拡張できる。

### 監査・コンプライアンス強化

- ScalarDLによる監査ログにより、J-SOXや内部統制要件を満たす。
- マスタ変更の完全な追跡可能性を実現。

## 類似事例・参考資料

- 製造業やサービス業がERPのサイド・バイ・サイド開発でScalarDBを利用し、データ整合性と柔軟な開発基盤を両立した例がある。
- 大企業がSAP S/4HANA移行時に、共通マスタサービスを外部化することで、移行コストを50%以上削減した事例がある。

## DB-10との関係について

このユースケースはDB-10「ERPアプリのサイド・バイ・サイド開発（補助簿）」と**相互補完、かつ強依存**の関係にある。

### 結論：DB-10とDB-17は"セット"で導入するべき

- **DB-10＝補助簿（サイドアプリ、トランザクションの外出し）**
- **DB-17＝共通マスタサービス化（マスタの外出し）**

DB-10が進むと必ず以下の状況が発生する：

- 補助簿アプリで追加属性が生まれる
- AIによるアプリ生成でマスタ属性が爆発
- ERPマスタでは対応不可能
- マスタの整合性を外で担保する必要が出る

つまり：

> **DB-10を本格的に採用するならDB-17も必然的に採用すべき（強い依存関係）。**

Scalar製品が非常に適合する組み合わせでもあります。

### 違いと補完関係

DB-10は補助簿（トランザクション）の外部化に焦点を当て、ERP本体と外部アプリのデータ整合性を保証する。一方、DB-17はマスタの外部化に焦点を当て、変化に強い共通マスタサービスを構築する。

提案時にはDB-10とDB-17を統合して説明し、ERPモダナイゼーションの完全なソリューションとして提示するのが効果的である。

## まとめ

**DB-17の本質**: ERPマスタを外部化し、AI時代の要件に対応可能な共通マスタサービスを構築する戦略。

DB-10の「補助簿サイドバイサイド化」が進むほど、DB-17の「マスタのサイドバイサイド化」は必然となり、ERP内のマスタを"唯一の主マスタ"として扱う時代は終わる。ScalarDBを用いてERPマスタを外部化し、構造化マスタはRDBで、非構造属性はNoSQLで管理し、ScalarDLで監査ログを保持する構成により、ERP移行コストを50〜80%削減し、AI時代の要求に柔軟に対応できる基盤を実現する。

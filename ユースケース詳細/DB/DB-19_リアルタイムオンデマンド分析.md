# DB-19 リアルタイムオンデマンド分析

## 概要

キャッシュレス決済や証券取引、保険査定など金融サービスでは、ユーザーの操作に対して瞬時にデータを集約・分析し、リスク評価や次のアクションを提示することが求められる。本ユースケースでは、基幹DBやDWH、データレイクを横断してリアルタイムまたはニアリアルタイムでデータ分析を行うプラットフォームを構築する。

## ビジネス課題

- クレジットカードの利用判定や不正検知をリアルタイムで実施したいが、基幹システムとDWH間のバッチ処理では遅延が大きい。
- データカタログやガバナンス機構とデータソース間の不整合により、利用者が必要なデータへ素早くアクセスできない。
- 分析部門と運用部門でツールやデータ基盤が分断され、分析結果を即座に業務へ反映できない。

## システム課題

- DWHやデータマートからデータを取得するために複数のETLやAPIを実装しており、可搬性とリアルタイム性が低い。
- 分散した複数DBからデータを結合する際に、一貫したトランザクションと整合性を保証する仕組みが不足している。
- 現行の分析基盤は読み取り専用で、リアルタイムにデータを更新するハイブリッドトランザクション・分析処理が難しい。

## 対象データ・環境

- 基幹システムの取引データや顧客情報、ログデータ。
- DWH（Snowflake等）、データマート、データレイク（S3やHDFS）。
- インメモリ処理基盤（Sparkなど）や可視化ツール。

## 導入目的・効果

- ユーザー操作に対する分析サイクル（データ取得→分析→洞察→アクション）を秒単位で回し、サービス品質を向上させる。
- 統合されたアクセス管理で、利用者が単一のAPIから必要なデータにアクセスできるようにする。
- バッチ処理の削減とETLコストの抑制。

## 解決方法（ソリューション概要）

ScalarDBをデータレイヤーとして導入し、基幹DBやDWH、データレイクを仮想的に統合する。アプリケーションや分析ツールはScalarDBのAPIを通じて必要なデータをストリーミング／バルクで取得し、リアルタイムに分析を実行する。また、ScalarDBはHTAPエンジンとして読み取りと書き込みを同時に扱えるため、分析結果に基づく更新操作を即時に基幹システムへ反映できる。統合されたアクセス制御により、データカタログと実データの整合性を保ちながら運用する。

## システム構成

- **データ統合レイヤー**：ScalarDBが基幹RDBMS、DWH、データレイクに接続し、仮想的な単一スキーマを提供する。Apache Kafkaなどのメッセージバスと連携してストリームデータも取り込む。
- **分析エンジン**：SparkやSnowflakeなどのエンジンがScalarDB経由でデータを取得し、機械学習モデルやリアルタイムダッシュボードを構築する。
- **アプリケーション層**：カード決済処理システムやコールセンターアプリがAPIゲートウェイを介してScalarDBにアクセスし、分析結果を即時に利用者へ返す。

## 導入メリット／ROI

- リアルタイム分析により、不正利用の早期検出やパーソナライズされたレコメンドが可能になり、収益機会の拡大とリスク低減につながる。
- データソースの複雑なETLやサイロを解消し、開発・運用コストを削減。
- 分析基盤と運用基盤を統合することで、ビジネス部門が迅速にインサイトを得て施策に反映できる。

## 類似事例・参考資料

- 決済業界や証券会社がリアルタイムに取引データを分析し、詐欺検知や不正送金の防止を実現した事例。ScalarDBを介することで基幹DBと分析基盤の整合性を保ちつつリアルタイム性を確保している。


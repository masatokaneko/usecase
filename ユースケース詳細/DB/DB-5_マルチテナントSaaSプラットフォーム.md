# DB-5 マルチテナントSaaSプラットフォーム

## 概要

SaaSベンダーでは、顧客ごとにデータ分離や性能要件が異なり、単一のDB構成では対応が困難な場合がある。このユースケースでは、テナントごとに最適なDBを選択しつつ、共通のAPIとトランザクション管理を提供するマルチテナント基盤を構築する。

## ビジネス課題

- テナントの規模や利用パターンに応じて性能・コスト要件が異なるため、一律のDB構成では過剰・不足が生じる。
- テナントごとにセキュリティポリシーや規制が異なり、データ分離やアクセス制御を厳格に管理する必要がある。
- 新しいDB製品への移行や拡張が困難で、サービスの俊敏性が失われる。

## システム課題

- テナントごとに異なるDBを採用すると、アプリケーションコードが複雑になり運用負荷が高まる。
- テナント間で共通機能を提供する場合、異種DB間で整合性を保つ仕組みが必要。
- マルチテナント環境ではアップグレードやメンテナンスがテナント全体に影響するリスクがある。

## 対象データ・環境

- 中小企業からエンタープライズまで様々な規模のテナントデータ。
- RDBMS、NoSQL、NewSQLなど異なるDBエンジン。
- クラウドベースのコンテナ／Kubernetes環境。

## 導入目的・効果

- テナントごとに最適なDBを選択し、コスト効率と性能を両立。
- テナントごとのデータ分離を徹底しつつ、共通機能の提供を簡素化。
- 新しいDB技術やクラウドサービスを迅速に採用できる柔軟性を確保。

## 解決方法（ソリューション概要）

ScalarDBのポリグロット・パーシステンス機能を活用し、テナントごとにRDBMSやNoSQLなど最適なDBを割り当てる。ScalarDBは異なるDBに対して共通のAPIを提供し、テナント固有のデータ操作と共通機能（請求・認証など）の両方をトランザクションで管理する。統一的なアクセス制御と暗号化により、テナント間のセキュリティを確保する。

## システム構成

- SaaSアプリケーションはScalarDB経由でテナントごとのDBにアクセスし、共通マスタDBとも連携。
- テナント単位でDBを水平スケール可能にし、テナント追加・削除の際にも他テナントに影響を与えない。
- RBAC/ABACによる細粒度なアクセス管理と列レベル暗号化を組み合わせ、規制要件に対応。

## 導入メリット／ROI

- アプリケーション側の実装をほぼ変更せずに、テナントごとに最適なDBを採用できるため、性能向上とコスト削減を同時に実現。
- 新規テナント追加や大規模テナントの拡張を短時間で行え、SaaSビジネスの拡張を加速。
- ベンダーロックインを回避し、将来的な技術刷新に対応しやすい。

## 類似事例・参考資料

- ITサービス業界で、RDBとNoSQLを併用しながらマルチテナントSaaSを提供する際にScalarDBを活用した例がある。
- ScalarDBは複数の異種データベースを同時に扱えることが強調されており、ポリグロット環境への適用が公式サイトで説明されている（参考: [scalar-labs.com](https://scalar-labs.com)）。


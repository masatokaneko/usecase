# APP-2 Excelアドオンによるマクロ業務の置き換え

## 概要

業務部門がデータベースからデータを取得してレポートを作成する際、ExcelマクロやVBAを大量に利用していることが多い。このユースケースでは、ScalarDBと連携するExcelアドオンを使い、自然言語クエリやテンプレート生成によってマクロ作業を不要にする。

## ビジネス課題

- 数万～数十万件規模のExcelマクロが乱立し、バージョン管理や保守がIT部門の負担となっている。
- 非技術者がDBにアクセスできないため、レポーティングや分析に時間がかかり、DXが進まない。
- 製油所などのプラントではセンサーデータが膨大で、約20万件のマクロ管理やIT部門との調整がボトルネックとなっているケースもある。

## システム課題

- 既存マクロは担当者が個別に作成しており、共通化されていない。
- データ取得先が複数のDBやAPIに分散し、マクロごとに接続処理を実装している。

## 対象データ・環境

- 生産実績、販売データ、センサーデータなどの業務データ。
- Excelを主要な分析ツールとする現場。

## 導入目的・効果

- マクロ管理の負担を減らし、非技術者でもデータ取得と分析をスムーズに行えるようにする。
- データの整合性とセキュリティを保ちながら、セルフサービスBIを実現。

## 解決方法（ソリューション概要）

ScalarDBとLangChain4jを組み込んだExcelアドオンを使用し、ユーザーはExcelリボンから自然言語でクエリを入力してデータを取得できる。取得したデータに対するグラフ作成や計算式はテンプレートとして自動生成されるため、従来のVBAマクロが不要。ABACと暗号化でデータアクセスを管理し、セキュアにレポート作成が可能。

## システム構成

- ExcelアドオンがScalarDBへの接続設定を保持し、ユーザー認証を行う。
- 自然言語クエリはLangChain4jが解析し、ScalarDBへのクエリに変換。
- 結果データをExcelに展開し、テンプレート機能でグラフや表を作成。

## 導入メリット／ROI

- マクロ作成や修正の工数を大幅削減し、IT部門の負担を軽減。
- 業務部門がデータ活用を自律的に行えるようになり、デジタル化が加速。

## 類似事例・参考資料

- プラント運用の現場などで、数十万件のマクロをExcelアドオンへ置き換え、レポート作成時間を短縮した例がある。

